

<manpage TITLE="createvol_rep" SECTNUM=8>
<mansect>NAME 
 <P>createvol_rep - create read-write replicated volume




<mansect>SYNOPSIS<P>
<bf>createvol_rep</bf> &lt;volume-name&gt; &lt;vsgaddr&gt; &lt;partition-name&gt; &lsqb;rep group id&rsqb;<P>


<mansect>DESCRIPTION<P>
<bf>createvol_rep</bf> is a front end to <em>volutil createvol&lowbar;rep</em> and is used to create a Coda read/write replicated volume.
The invoker must specify the volume name (<em>&lt;volume-name&gt;)</em>,
the replication sites via a Volume Server Group address (<em>&lt;vsgaddr&gt;)</em>, 
the partition on which the volume should be created (<em>&lt;partition-name&gt;)</em>,
and an optional <em>Group Id</em>.  

<bf>createvol_rep</bf> first checks in  <em>/vice/vol/AllVolumes</em> and 
<em>/vice/vol/VRList</em> to see if the volume name already exists.  If not, 
it uses the <em>volutil create_rep</em> command to create the volume at each of 
the replication sites.  It then builds the Volume Location Data Base (VLDB)
and the Volume Replication Data Base (VRDB).

The replication sites are determined from the 
<em>&lt;vsgaddr&gt;</em> and the <em>/vice/db/VSGDB</em> file.  
The <em>Rep Group Id</em> specifies the "replicated" volumeid of the volume 
being created.  By default, the group id in <em>/vice/vol/maxgroupid</em> is 
used.  Each time it is used it is also updated by adding 1 to it.

After the replicas are created at each replication site, a new VLDB is built
automatically using <em>bldvldb.sh</em>(8), and the Volume Replication
List in <em>/vice/vol/VRList</em> is updated.  The VRList contains one line for 
each replicated volume.  Each line specifies the replicated volume name, 
group id, number of replication sites, 
local volume id at each replication site and
the VSG address.  This file is now used to create a new Volume Replication 
Data Base (VRDB) using the <em>"volutil makevrdb /vice/vol/VRList"</em> command.


<mansect>EXAMPLES<P>
To create a replicated volume "coda.rep" on 3 sites foo, bar and  gorp use:

<descrip>
<tag><bf>createvol_rep coda.rep E0000107 /vicapa</bf></tag> 
<P></descrip>

where <em>/vice/db/VSGDB</em> has an entry "E0000107 foo bar gorp" in it.  

To assign a predetermined Group Id, use

<descrip>
<tag><bf>createvol_rep coda.rep E0000107 /vicepa 7F000003</bf></tag> 
<P></descrip>

where "7F000003" is the Group Id.



<mansect>DIAGNOSTICS<P>
This command must be issued at the System Control Machine (SCM).  Also, it 
must be invoked with effective user id of root.  This command does not check 
for return codes from the <em>volutil create_rep</em> command.  The invoker 
must check <em>/vice/vol/VRList</em> and <em>/vice/vol/VolumeList</em> at each 
replication site to see if the volume was created.



<mansect>FILES<P>
<descrip>
<tag><em>/vice/vol/VRList</em></tag>contains information on replicated volumes 
<P></descrip>
<descrip>
<tag><em>/vice/vol/VolumeList</em></tag>name of volume created at each site is appended to it 
<P></descrip>
<descrip>
<tag><em>/vice/db/VRDB</em></tag>is used to describe the replicated volumes in terms of its non-replicated members.
<P></descrip>
<descrip>
<tag><em>/vice/db/VSGDB</em></tag>is used to translate the VSG address to replication sites
<P></descrip>
<descrip>
<tag><em>/vice/vol/AllVolumes</em></tag>is used to check if volume exists 
<P></descrip>
<descrip>
<tag><em>/vice/vol/maxgroupid</em></tag>is used to assign a group id to the replicated volume
<P></descrip>



<mansect>SEE ALSO<P>
bldvldb.sh (8), volutil (8), createvol (8)



<mansect>AUTHOR<P>
Puneet Kumar, 1990, Created








</manpage>
