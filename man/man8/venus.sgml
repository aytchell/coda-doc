<!doctype linuxdoc system>

<manpage TITLE="venus" SECTNUM=8>
<sect1>NAME 
 <P>venus - client cache manager




<sect1>SYNOPSIS<P>
<bf>venus</bf>   &lsqb; -k kernel device &rsqb;  &lsqb; -h host list &rsqb;  &lsqb; -cf cache files &rsqb;  &lsqb; -c cache blocks &rsqb;  &lsqb;-mles CML entries&rsqb;<P>
	&lsqb; -d debug level &rsqb;  &lsqb; -r root volume &rsqb;  &lsqb; -f cache directory &rsqb;  &lsqb; -m COP modes &rsqb;<P>
	&lsqb; -mc 0 | 1 &rsqb;  &lsqb; -console console file &rsqb;  &lsqb; -retries RPC2 retries &rsqb;  &lsqb; -timeout RPC2 timeout &rsqb;<P>
	&lsqb; -ws SFTP window size &rsqb;  &lsqb; -sa SFTP send ahead &rsqb;  &lsqb; -ap SFTP ack point &rsqb;  &lsqb; -init &rsqb;  &lsqb; -p &rsqb;<P>
        &lsqb; -hdbes hoard entries&rsqb; &lsqb;-rvmt RVM type&rsqb; &lsqb;-sim infile outfile filtfile systype&rsqb;<P>
        &lsqb; -mondhost hostname&rsqb; &lsqb; -mondport port &rsqb; &lsqb; -maxprefetchers fetch threads &rsqb;<P>
        &lsqb; -maxworkers work threads&rsqb; &lsqb; -maxcbservers cb threads &rsqb; &lsqb; -vld device &rsqb; &lsqb; -vlds size &rsqb;<P>
        &lsqb;-vdd device &rsqb; &lsqb; -vdds size &rsqb; &lsqb; -rdscs chunk size &rsqb; &lsqb; -rdsnl nlists &rsqb; &lsqb; -logopts 0 | 1 &rsqb; <P>
        &lsqb; -swt weight &rsqb; &lsqb; -mwt weight &rsqb; &lsqb; -ssf scale factor &rsqb; &lsqb; mount point &rsqb;<P>



<sect1>DESCRIPTION<P>
<bf>venus</bf> manages a cache of files and directories for a client workstation.  It has a host of parameters and configuration options.  Default values of everything are compiled into <bf>venus</bf> (see <em>&lt;venus.private.h&gt;) for these values</em>.  Some of these are overridden by the values in the <em>vstab</em>(5), provided that it exists.  Both default and vstab values may be overridden with command-line arguments.  Venus must be run as root.

The command-line options are:
<descrip>
<tag><bf>-k</bf> <em>kernel device</em></tag>Take <em>kernel device</em> to be the device for kernel/venus communication.<P>
Default: <em>/dev/cfs0</em>
<P></descrip>
<descrip>
<tag><bf>-h</bf> <em>host list</em></tag>Take comma-separated <em>host list</em> to be the initial set of hosts to be used for volume-location requests.
<P></descrip>
<descrip>
<tag><bf>-cf</bf> <em>cache files</em></tag>Limit the size of the file cache to <em>cache files</em> entries.<P>
Default: <em>512</em>
<P></descrip>
<descrip>
<tag><bf>-c</bf> <em>cache blocks</em></tag>Limit the size of the file cache to <em>cache blocks</em> 1K blocks.<P>
Default: <em>8192</em>
<P></descrip>
<descrip>
<tag><bf>-mles</bf> <em>CML entries</em></tag>Number of Cache Modify Log entries
<P></descrip>
<descrip>
<tag><bf>-vols</bf> <em>volumes</em></tag>Limit the size of the volume cache to <em>volumes</em> entries.<P>
Default: <em>128</em>
<P></descrip>
<descrip>
<tag><bf>-vsgs</bf> <em>vsgs</em></tag>Limit the size of the VSG cache to <em>vsgs</em> entries.<P>
Default: <em>64</em>
<P></descrip>
<descrip>
<tag><bf>-d</bf> <em>debug level</em></tag>Initialize the debug level to <em>debug level</em>.  Meaningful values are &lcub;0, 1, 10, 100, 1000&rcub;.<P>
Default: <em>0</em>
<P></descrip>
<descrip>
<tag><bf>-r</bf> <em>root volume</em></tag>Take <em>root volume</em> to be the root volume of the file system.  This should be a string name rather than a number.  There is no default.  If no value is given, venus will ask one of the file servers.  &lsqb;N.B.  If you intend to operate disconnected, a value must be supplied.&rsqb;<P>
Default: <em>none</em>
<P></descrip>
<descrip>
<tag><bf>-f</bf> <em>cache directory</em></tag>Take <em>cache directory</em> to be the directory for the file, volume, and VSG caches.  Venus garbage collects any files it doesnt recognize in the cache directory, so use caution when supplying this argument.  Venus will create the directory if it doesnt already exist.  The directory should have mode bits of <em>rwx------</em> to protect the cache from malicious local users.<P>
Default: <em>/usr/coda/venus.cache</em>
<P></descrip>
<descrip>
<tag><bf>-m</bf> <em>COP modes</em></tag>Controls what Coda Optimistic Protocol (COP) options are enabled.  <em>COP modes</em> is interpreted according to the following bit-mask: &lsqb; PIGGYCOP2 | ASYNCCOP2 | ASYNCCOP1 &rsqb;.  Only some combinations are legal.<P>
Default: <em>&lsqb; PIGGYCOP2 | ASYNCCOP2 &rsqb;</em>
<P></descrip>
<descrip>
<tag><bf>-mc</bf> <em>0 | 1</em></tag>Controls whether multicast is used or not (0
<P></descrip>
<descrip>
<tag><bf>-console</bf> <em>console file</em></tag>Redirects console messages to <em>console file</em>.<P>
Default: <em>/dev/console</em>
<P></descrip>
<descrip>
<tag><bf>-retries</bf> <em>RPC2 retries</em></tag>Sets the number of RPC2 retries to <em>RPC2 retries</em>.<P>
Default: <em>4</em>
<P></descrip>
<descrip>
<tag><bf>-timeout</bf> <em>RPC2 timeout</em></tag>Sets the RPC2 timeout period to <em>RPC2 timeout</em> seconds.<P>
Default: <em>30</em>
<P></descrip>
<descrip>
<tag><bf>-ws</bf> <em>SFTP window size</em></tag>Sets the SFTP window size to <em>SFTP window size</em> packets.<P>
Default: <em>8</em>
<P></descrip>
<descrip>
<tag><bf>-sa</bf> <em>SFTP send ahead</em></tag>Sets the SFTP send ahead to <em>SFTP send ahead</em> packets.<P>
Default: <em>4</em>
<P></descrip>
<descrip>
<tag><bf>-ap</bf> <em>SFTP ack point</em></tag>Sets the SFTP ack point to <em>SFTP ack point</em> packets.<P>
Default: <em>4</em>
<P></descrip>
<descrip>
<tag><bf>-init</bf></tag>Initializes LEFTPAREN i.e., clears) file, volume, and VSG caches.
<P></descrip>
<descrip>
<tag><bf>-p</bf></tag>Enables profiling.
<P></descrip>
<descrip>
<tag><bf>-hdbes</bf> <em>hoard entries</em></tag>Number of hoard database entries.
<P></descrip>
<descrip>
<tag><bf>-rvmt</bf> <em>RVMT type</em></tag>Media that RVM resides on.  Meaningful values are: 1
<P></descrip>
<descrip>
<tag><bf>-sim</bf> <em>infile outfile filtfile systype</em></tag>Turn on simulator mode.  <em>infile</em> is a trace to load in to the simulation.  <em>outfile</em> is the output file for the simulation.  <em>filtfile</em> is a filter for the trace.  And <em>systype</em> is the system type the trace was taken on.
<P></descrip>
<descrip>
<tag><bf>-mondhost</bf> <em>hostname</em></tag>Host where <em>mond</em> database is stored
<P></descrip>
<descrip>
<tag><bf>-mondportal</bf> <em>port</em></tag>Port to use when contacting the <em>mond</em> host.
<P></descrip>
<descrip>
<tag><bf>-maxprefetchers</bf> <em>fetch threads</em></tag>Maximum number of threads doing prefetch ioctls
<P></descrip>
<descrip>
<tag><bf>-maxworkers</bf> <em>work threads</em></tag>Number of worker threads.
<P></descrip>
<descrip>
<tag><bf>-maxcbservers</bf> <em>cb threads</em></tag>Number of callback server threads.
<P></descrip>
<descrip>
<tag><bf>-vld</bf> <em>device</em></tag>Location of the venus log device.<P>
Default: <em>/usr/coda/LOG</em>
<P></descrip>
<descrip>
<tag><bf>-vlds</bf> <em>size</em></tag>Size of the log device.
<P></descrip>
<descrip>
<tag><bf>-vdd</bf> <em>device</em></tag>Location of the venus data device.<P>
Default: <em>/usr/coda/DATA</em>
<P></descrip>
<descrip>
<tag><bf>-rdscs</bf> <em>chunk size</em></tag>Specify RDS chunk size.
<P></descrip>
<descrip>
<tag><bf>-rdsnl</bf> <em>nlists</em></tag>Number of RDS nlists.
<P></descrip>
<descrip>
<tag><bf>-logopts</bf> <em>0 | 1</em></tag>Turn on log optimization.
<P></descrip>
<descrip>
<tag><bf>-swt</bf> <em>weight</em></tag>Short term cache priority weight.
<P></descrip>
<descrip>
<tag><bf>-mwt</bf> <em>weight</em></tag>Medium term cache priority weight.
<P></descrip>
<descrip>
<tag><bf>-ssf</bf> <em>scale factor</em></tag>Short term cache scale factor.
<P></descrip>
<descrip>
<tag><em>mount point</em></tag>Directory to serve as the mount point for Coda.<P>
Default: <em>/coda</em>
<P></descrip>



<sect1>DIAGNOSTICS<P>
Venus writes debugging information into the file &lt;cache directory&gt;/venus.log.  The verbosity of this output is controlled by the &lt;debug level&gt; parameter.  High priority messages are also written to the console (which may be redirected with the console option at start-up).  Fatal errors will cause the internal state of venus to be dumped to the log file, and a core file to be left in &lt;cache directory/core&gt;.

Venus writes its process id into the file &lt;cache directory&gt;/pid.  The vutil (8v) program reads the pid file and dynamically alter Venus behavior by sending signals to it.

Venus may be unable to unmount itself cleanly when it exits.  Usually this is due to processes which have references to vnodes in the Coda namespace (e.g., a process is cded somewhere in Coda).  Once these references are released, Venus can be unmounted with cfsunmount (8v).



<sect1>FILES<P>
<em>/usr/coda/etc/vstab</em>

<em>&lt;cache directory&gt;/venus.log</em>

<em>&lt;cache directory&gt;/pid</em>

<em>&lt;venus.private.h&gt;</em>



<sect1>BUGS<P>
A mount point of <em>/coda</em> is assumed by the pioctl library.

A cache directory of <em>/usr/coda/venus.cache</em> is assumed by vutil (8v).


<sect1>SEE ALSO<P>
vstab (5), cfsunmount (8v), vutil (8v)


<sect1>AUTHOR<P>
Jay Kistler, 1990, Created

Joshua Raiff, 1993, Documented added switches





</manpage>
