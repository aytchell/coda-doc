
<!doctype linuxdoc system>

<manpage TITLE="bldvldb.sh" SECTNUM=8>
<sect1>NAME 
 <P>bldvldb.sh - build a new Volume Location Data Base (VLDB)



<sect1>SYNOPSIS<P>
<bf>bldvldb.sh</bf><P>


<sect1>DESCRIPTION<P>
<bf>bldvldb.sh</bf> builds a new volume location data base <bf>VLDB</bf>.  
It uses the 
<em>/vice/db/hosts</em> file to get a list of servers to use to retrieve
the current list of volumes.  It gets the list from the 
<em>/vice/vol/VolumeList</em> file on each server.  It combines the list 
into <em>/vice/vol/BigVolumeList</em> and 
passes the combined list as a parameter to the <bf>volutil makevldb</bf>
command.  This command produces a new <bf>VLDB</bf> in <em>/vice/db</em> and 
updates the files <em>AllVolumes</em> and <em>partitions</em> in <em>/vice/vol</em>.
You must have root priveledges to run this command.



<sect1>DIAGNOSTICS<P>
This command can only be issued on the System Control Machine (SCM). Bldvldb uses
two mechanisms to get the VolumeList files from the various servers in
<em>/vice/db/hosts</em>. The first is ftp. In order for this to succeed, there has to
be a file called ".anonr" in the directory <em>/vice/vol</em>, which is globally
readable and contains a line with the word "VolumeList" in it. If
<bf>bldvldb.sh</bf> is unable to get the file via ftp, it will attempt to use
the CMU RFS remote file system. If neither mechanism works, <bf>bldvldb.sh</bf> will
skip over that servers volumes when building the <bf>VLDB</bf>.  The
databases are propagated via the update protocol.  This takes up to
five minutes.  Attempts to access a new volume from a client, prior to the
propagation of all the databases to all servers, may fail.



<sect1>FILES<P>
<descrip>
<tag><em>/vice/vol/AllVolumes</em></tag>is created
<P></descrip>
<descrip>
<tag><em>/vice/db/VLDB</em></tag>is created
<P></descrip>
<descrip>
<tag><em>/vice/vol/VolumeList</em></tag>on each server is used to build the VLDB
<P></descrip>
<descrip>
<tag><em>/vice/db/hosts</em></tag>is a list of the active servers
<P></descrip>
<descrip>
<tag><em>/vice/vol/BigVolumeList</em></tag>is the result of combining <em>/vice/vol/VolumeList</em> from each server
<P></descrip>



<sect1>SEE ALSO<P>
update (8), volutil (8)



<sect1>AUTHOR<P>
Puneet Kumar, 1990, Created


</manpage>
