
<!doctype linuxdoc system>

<manpage TITLE="mdd" SECTNUM=8>
<sect1>NAME 
 <P>mdd - copy disk partitions to/from tape



<sect1>SYNOPSIS<P>
<bf>mdd</bf>   &lsqb;<bf>-i</bf> inputfile&rsqb; &lsqb;<bf>-o</bf> outputfile&rsqb; &lsqb;<bf>-b</bf> blocksize&rsqb; &lsqb;<bf>-d</bf>&rsqb; <bf>-&lsqb;f | u | l&rsqb;</bf><P>


<sect1>DESCRIPTION<P>
<em>mdd</em> copies its input to its output formatting or
unformatting depending upon the option.

The parameters are:
<descrip>
<tag><bf>-i</bf></tag>Use the next argument as the input file.  Default: stdin
<P></descrip>

<descrip>
<tag><bf>-o</bf></tag>Use the next argument as the output file.  
Default: stdout
<P></descrip>

<descrip>
<tag><bf>-b</bf></tag>Use the next argument as the blocksize.  
Default: 512
<P></descrip>

<descrip>
<tag><bf>-v</bf></tag>Provide extra output information (&tilde;verbose)
<P></descrip>

<descrip>
<tag><bf>-f</bf></tag>Format the input
<P></descrip>

<descrip>
<tag><bf>-u</bf></tag>Unformat the input
<P></descrip>

<descrip>
<tag><bf>-l</bf></tag>List the formatting information
<P></descrip>

One of <bf>f</bf>, <bf>u</bf>, or <bf>l</bf> is required.  The <bf>f</bf>
option formats the input onto the output.  The <bf>u</bf> option unformats
the input onto the output.  The <bf>l</bf> option reads the formatting
information from the input and prints it to the standard output.  Formatted
data is typically associated with a tape device while unformatted data is
associated with a disk partition.  The <bf>f</bf> (<bf>u)</bf> option
requires that the input (output) come from a "known" disk type and partition
(currently, SC400 disk partitions /dev/rsd*a, /dev/rsd*b and /dev/rsd*g).

When formatting, the program writes one <bf>blocksize</bf> block of 
formatting data as the first block on the output.  This information contains 
the blocksize, the number of full blocks, the number of valid bytes in the 
final block, the machine name and partition containing the original input, 
and the current date and time.  Formatting consists of writing the output 
in blocks of <bf>blocksize</bf> bytes.  The final (probably, partial) block is 
zero-filled before being written. 

When unformatting, the program reads the formatting block and checks
that the output file is on the specified machine and partition.  (This is a
safety check which can easily be changed but requires recompilation.)
The number of full blocks specified are then read and written to the output
file followed by the final (partial) block.  Care is taken NOT to write past
the end of the disk partition (dd fails for this application precisely for this
reason).  

This program is capable of supporting other disk partitions.
The only required information necessary about each disk partition is the
number of 512 byte segments (easily acquired from /etc/disktab).  
Also, minor changes would be required for the program to recognize 
new disk partitions from their name and to resolve any name conflicts.



<sect1>DIAGNOSTICS<P>
The program prints the number of full and partial blocks read/written
and whether or not the numbers indicate an error occurred.  Because
of formatting, the numbers will not (and should not) be identical.
Formatted data should have two extra full blocks (one containing
formatting information and the other containing the final, "partial" block).
Unformatted data should have one partial block.



<sect1>BUGS<P>
When reading the tape, the 8mm tape device driver on the Sun
does not always leave the tape ready to read the next tape file.
Simply retrying the command should work.  This problem may
be fixed in the next version of the device driver.


To use mdd in a backup system running under the Mach operating
system, you MUST specify that the partitions you will backup may
NOT be used for paging (see mach&lowbar;swapon).  
&lsqb;Inodes may be marked as allocated/deallocated by the inode&lowbar;pager
during the time of the backup.  The inode may be subsequently 
deallocated/allocated.  However, after a restore, the inodes will
reflect their state at the time the backup was taken and may not
correspond to the inode&lowbar;pager table.  This situation causes the system 
to "panic".&rsqb;


<sect1>SEE ALSO<P>
autobackup (8)


<sect1>AUTHOR<P>
Maria Ebling Okasaki


</manpage>
